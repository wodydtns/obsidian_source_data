1. 장치 컨트롤러와 장치 드라이버
    - 장치 컨트롤러
        - 입출력장치를 다루기 어려운 이유
            - 입출력장치의 종류가 너무 많음
            - 일반적으로 CPU와 메모리의 데이터 전송률은 높지만 입출력장치의 데이터 전송률은 낮음
            - 이를 해결하기 위해 **장치 컨트롤러**라는 하드웨어를 통해 컴퓨터에 연결
        - 장치 컨트롤러가 해결하는 문제
            - CPU와 입출력장치 간의 통신 중개
            - 오류 검출
            - 데이터 버퍼링
                - 버퍼(buffer) : 데이터를 임시 저장하는 공간
        - 장치 컨트롤러의 내부 구조
            
            ![[Untitled 13 2.png|Untitled 13 2.png]]
            
        - 데이터 레지스터(data register)
            - CPU와 입출력장치 사이에 주고받을 데이터가 담기는 레지스터
            - 버퍼 역할
        - 상태 레지스터(state register)
            - 입출력장치의 준비, 작업 완료, 오류 유무 등의 상태 정보 저장
        - 제어 레지스터(control register)
            
            - 입출력장치가 수행할 내용에 대한 제어 정보와 명령을 저장
            
              
            
              
            
    - 장치 드라이버
        - 장치 컨트롤러의 동작을 감지하고 제어함으로써 장치 컨트롤러가 컴퓨터 내부와 정보를 주고 받을 수 있게 하는 프로그램
2. 다양한 입출력 방법
    - 프로그램 입출력 programmed I/O
        - 메모리에 저장된 정보를 하드 디스크에 백업하는 상황
            - 1. CPU가 하드 디스크 컨트롤러의 제어 레지스터에 쓰기 명령을 보냄
                
                ![[Untitled 14 2.png|Untitled 14 2.png]]
                
            - 2. 하드 디스크 컨트롤러가 하드 디스크 사앹를 확인하고 준비 상태라면 하드 디스크 컨트롤러가 상태 레지스터에 준비되었다고 표시함
                
                ![[Untitled 15 2.png|Untitled 15 2.png]]
                
            - 3. CPU가 상태 레지스터를 주기적으로 읽어보며 하드 디스크의 준비 여부를 확인하고 하드 디스크가 준비되었다는 것을 CPU가 알게 되면 백업할 메모리의 정보를 데이터 레지스터에 씀 ⇒ 쓰기 작업이 끝나지 않았다면 01번부터 반복하고, 쓰기가 끝났다면 작업을 종료
                
                ![[Untitled 16 2.png|Untitled 16 2.png]]
                
        - 메모리 맵 입출력(memory-mapped I/O)
            - 메모리에 접근하기 위한 주소 공간과 입출력장치에 접근하기 위한 주소 공간을 하나의 주소 공간으로 간주하는 방법
            - CPU는 메모리의 주소들이나 장치 컨트롤러의 레지스터들이나 모두 똑같이 메모리 주소를 대하듯 하면 가능 ⇒ 메모리에 접근하는 명령어와 입출력장치에 접근하는 명령어가 굳이 다를 필요가 없음
            - 예시
                - 1024개의 주소를 표현하는 컴퓨터가 있을 때 ⇒ 512개는 메모리 주소, 512개는 장치 컨트롤러의 레지스터를 표현하기 위해 사용
        - 고립형 입출력(isolated I/O)
            - 메모리를 위한 주소 공간과 입출력장치를 위한 주소 공간을 분리하는 방법
            - 예시
                
                ![[Untitled 17 2.png|Untitled 17 2.png]]
                
            - 메모리에 접근하는 명령어와 입출력장치에 접근하는 명령어를 다르게 사용
    - 인터럽트 기반 입출력
        - 장치 컨트롤러가 입출력 작업을 끝낸 뒤 CPU에게 인터럽트 요청 신호를 보내면 CPU가 하던 일을 잠시 백업하고 인터럽트 서비스 루틴을 실행 ⇒ 이런 인터럽트를 기반으로 하는 입출력
        - 여러 입출력장치에서 인터럽트가 동시에 발생하는 경우
            - 인터럽트 간에 우선순위를 고려해 우선순위가 높은 인터럽트 순으로 여러 인터럽트 처리
            - 프로그래머블 인터럽트 컨트롤러(PIC, Programmable Interrupt Controller)
                
                - 여러 장치 컨트롤러에 연결되어 장치 컨트롤러에서 보낸 하드웨어 인터럽트 요청들의 우선순위를 판별해 CPU에 지금 처리해야 할 하드웨어 인터럽트가 뭔지 알려주는 장치
                - 예시
                
                ![[Untitled 18 1.png|Untitled 18 1.png]]
                
                - PIC의 다중 인터럽트 처리 과정
                    - 1. PIC가 장치 컨트롤러에서 인터럽트 요청 신호들을 받아들임
                    - 2. PIC가 인터럽트 우선순위를 판단한 뒤 CPU에 처리해야 할 인터럽트 요청 신호를 보냄
                    - 3. CPU는 PIC에 인터럽트 확인 신호를 보냄
                    - 4. PIC는 데이터 버스를 통해 CPU에 인터럽트 벡터를 보냄
                    - 5. CPU는 인터럽트 벡터를 통해 인터럽트 요청의 주체를 알게 되고, 해당 장치의 인터럽트 서비스 루틴을 실행
    - DMA 입출력(Direct Memory Access)
        - 입출력장치와 메모리가 CPU를 거치지 않고도 상호작용할 수 있는 입출력 방식
        - DMA 입출력을 위한 시스템 버스에 연결된 DMA 컨트롤러라는 하드웨어 필요
        - 구조
            
            ![[Untitled 19 1.png|Untitled 19 1.png]]
            
        - DMA 입출력 과정
            
            1. CPU가 DMA 컨트롤러에 입출력장치의 주소, 수행할 연산(I/O), 읽거나 쓸 메모리의 주소 등과 같은 정보로 입출력 작업을 명령
            
            ![[Untitled 20 1.png|Untitled 20 1.png]]
            
            1. DMA 컨트롤러는 CPU 대신 장치 컨트롤러와 상호작용하며 입출력 작업을 수행, 이 때 DMA 컨트롤러가 필요한 경우 메모리에 직접 접근해 정보를 읽거나 씀
            
            ![[Untitled 21 1.png|Untitled 21 1.png]]
            
            1. 입출력 작업이 끝나면 DMA 컨트롤러는 CPU에 인터럽트를 걸어 작업이 끝났음을 알림
            
            ![[Untitled 22 1.png|Untitled 22 1.png]]
            
        - DMA 컨트롤러는 시스템 버스로 메모리에 직접 접근 가능하지만, 시스템 버스는 동시 사용이 불가능 ⇒ 시스템 버스는 공용 자원 ⇒ CPU가 시스템 버스를 이용하지 않을 때마다 조금씩 시스템 버스를 이용하거나, CPU가 일시적으로 시스템 버스를 이요하지 않도록 허락을 구하고 시스템 버스를 집중적으로 이용
        - DMA의 시스템 버스 이용 방법
            
            ![[Untitled 23 1.png|Untitled 23 1.png]]
            
        - 입출력 버스
            
            - 1. 메모리에서 DMA 컨트롤러로 데이터를 가져오기 위한 시스템 버스를 한 번 사용
            - 2. DMA 컨트롤러의 데이터를 장치 컨트롤러로 옮기기 위해 시스템 버스를 한 번 더 사용
            
            ![[Untitled 24 1.png|Untitled 24 1.png]]
            
            - 입출력장치를 컴퓨터 내부와 연결 짓는 통로